# gRPC Service Plugin Configuration Example
lynx:
  grpc:
    service:
      # Network type: tcp or unix
      network: "tcp"
      
      # Server address and port
      addr: ":9090"
      
      # Enable/disable TLS
      tls_enable: false
      
      # TLS client authentication type:
      # 0: No client authentication
      # 1: Request client certificate, but not mandatory
      # 2: Require client certificate
      # 3: Verify client certificate
      # 4: Verify client certificate if provided
      tls_auth_type: 0
      
      # Request timeout duration (in seconds)
      timeout: 10
      
      # Maximum number of concurrent streams per HTTP/2 connection
      # This is an important parameter for controlling server resource usage
      # Default: 1000 (safe default, adjust based on capacity)
      # Recommended: Set based on your server capacity (typical range: 100-10000)
      # Example values:
      #   - Small service: 100-500
      #   - Medium service: 500-2000
      #   - Large service: 2000-10000
      max_concurrent_streams: 1000

      # Maximum inbound/outbound message sizes (bytes)
      # Default 0 uses gRPC defaults (~4MB); set explicit values to control memory usage
      max_recv_msg_size: 10485760   # 10MB
      max_send_msg_size: 10485760   # 10MB

      # Optional server options (extend behavior without proto changes)
      # Graceful shutdown: max time to wait when stopping the server (default: 30s)
      # graceful_shutdown_timeout: 30s
      # Middleware toggles (default: all true)
      # enable_tracing: true
      # enable_request_logging: true
      # enable_metrics: true
      # In-process rate limit (optional)
      # rate_limit:
      #   enabled: false
      #   rate_per_second: 100
      #   burst: 200
      # Max concurrent unary RPCs (0 = unlimited)
      # max_inflight_unary: 0
      # Server-side circuit breaker (opens after failure_threshold failures, returns Unavailable when open)
      # circuit_breaker:
      #   enabled: false
      #   failure_threshold: 5
      #   recovery_timeout: 30s
      #   success_threshold: 3
      #   timeout: 10s
      #   max_concurrent_requests: 10

# Example with TLS enabled
# lynx:
#   grpc:
#     service:
#       network: "tcp"
#       addr: ":9090"
#       tls_enable: true
#       tls_auth_type: 4  # Mutual TLS authentication
#       timeout: 30
